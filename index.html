<!DOCTYPE html>
<html>
<head>
    <title>iOS 测试版分发</title>

                <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
    <style>
        body { max-width: 800px; margin: 20px auto; font-family: sans-serif }
        .qrcode { margin: 20px 0; border: 1px solid #ddd; padding: 10px }
        .version { padding: 10px; margin: 10px 0; border-left: 3px solid #007bff }
    </style>
</head>
<body>
    <h1>当前版本: <span id="currentVersion">加载中...</span></h1>
    <div id="qrcode" class="qrcode"></div>
    <a id="installLink" href="#">安装最新版</a>

    <label for="customUrl">自定义下载 URL:</label>
    <textarea id="customUrl" name="customUrl" cols="30" rows="3">itms-services://?action=download-manifest&url=https://tsdaodao.github.io/tsddipa/app.plist</textarea>

   <button onclick="buttonclick()">buttonclick</button>
   
<br>
       <a href="itms-services://?action=download-manifest&url=https://tsdaodao.github.io/tsddipa/app.plist">net18download p</a>
    <br>
       <a href="itms-services://?action=download-manifest&url=https://tsdaodao.github.io/tsddipa/appdesktop.plist">net100mac p</a>
    <br>

   <script>
        const customUrlInput = document.getElementById("customUrl");
        const installLink = document.getElementById("installLink");
        customUrlInput.addEventListener("input", function() {
            installLink.href = customUrlInput.value;
        });

        function buttonclick() {
            const customUrl = customUrlInput.value;
             //下载
            window.location.href = customUrl;
        }
    </script>

    <h2>更新说明</h2>
    <div id="releaseNotes"></div>

    <h2>历史版本</h2>
    <div id="versionHistory"></div>

    <script>

        
        // 配置区 (需手动维护)
        const config = {
            baseUrl: "https://yourusername.github.io/repo-name/", // 修改为你的 Pages 地址
            versions: [
                {
                    version: "1.2.0",
                    date: "2024-03-20",
                    notes: "1. 新增用户反馈功能\n2. 优化性能表现",
                    ipa: "app_v1.2.0.ipa",
                    bundleId: "com.yourcompany.app",
                    title: "My Test App"
                },
                {
                    version: "1.1.0",
                    date: "2024-03-15",
                    notes: "1. 修复登录问题\n2. 添加夜间模式",
                    ipa: "app_v1.1.0.ipa",
                    bundleId: "com.yourcompany.app",
                    title: "My Test App"
                }
            ]
        };

        // 自动生成页面
        window.onload = () => {
            const current = config.versions[0];
            const plistUrl = `${config.baseUrl}plists/${current.version}.plist`;
            const installUrl = `itms-services://?action=download-manifest&url=${encodeURIComponent(plistUrl)}`;

            // 显示基础信息
            document.getElementById('currentVersion').textContent = current.version;
            document.getElementById('installLink').href = installUrl;
            document.getElementById('releaseNotes').innerHTML = current.notes.replace(/\n/g, '<br>');

            // 生成二维码 (指向安装链接)
            new QRCode(document.getElementById("qrcode"), {
                text: window.location.href,
                width: 200,
                height: 200
            });
 new QRCode(document.getElementById("qrcode2"), {
                text: "https://tsdaodao.github.io/tsddipa/",
                width: 200,
                height: 200
            });
            // 生成历史版本
            const historyDiv = document.getElementById('versionHistory');
            config.versions.forEach(v => {
                const itemPlist = `${config.baseUrl}plists/${v.version}.plist`;
                const itemUrl = `itms-services://?action=download-manifest&url=${encodeURIComponent(itemPlist)}`;
                
                historyDiv.innerHTML += `
                    <div class="version">
                        <h3>v${v.version} (${v.date})</h3>
                        <p>${v.notes.replace(/\n/g, '<br>')}</p>
                        <a href="${itemUrl}">安装此版本</a>
                    </div>
                `;
            });
        };
    </script>
</body>

        <div id="qrcode2" class="qrcode2"></div>

</html>
